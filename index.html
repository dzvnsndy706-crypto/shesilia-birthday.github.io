<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Birthday Sayangku ‚ù§Ô∏è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            text-align: center;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: #000;
            overflow: hidden;
        }
        
        .background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('bg.jpeg');
            background-size: cover;
            background-position: center;
            filter: blur(3px) brightness(0.9);
            z-index: -2;
            transform: scale(1.02);
        }
        
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3);
            z-index: -1;
        }
        
        .btn {
            padding: 16px 32px;
            font-size: 18px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #ff4d6d, #ff758f);
            color: white;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(255, 77, 109, 0.4);
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            margin-bottom: 25px;
            font-weight: bold;
            outline: none;
            position: relative;
            z-index: 20; /* Ensure button is above other layers */
        }
        
        .btn:hover {
            transform: translateY(-3px) scale(1.03);
            box-shadow: 0 10px 25px rgba(255, 77, 109, 0.5);
        }
        
        .btn:active {
            transform: translateY(1px);
        }
        
        .gift-showcase {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 30px;
            z-index: 25;
        }
        
        .gift-box {
            font-size: 70px;
            animation: float 3.5s ease-in-out infinite;
            cursor: pointer;
            transition: transform 0.3s ease;
            will-change: transform;
        }
        
        .gift-box:hover {
            animation: float 2s ease-in-out infinite, pulse 1.5s ease infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-25px) rotate(5deg); }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.15); }
        }
        
        .message {
            color: white;
            display: none;
            font-size: 16px;
            margin: 20px auto;
            line-height: 1.7;
            background: rgba(50, 50, 50, 0.85);
            padding: 22px;
            border-radius: 12px;
            max-width: 100%;
            animation: fadeIn 0.8s ease-out forwards;
            border: 1px solid rgba(255, 255, 255, 0.15);
            text-align: left;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.4);
            position: relative;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .heart {
            position: absolute;
            font-size: 24px;
            color: #ff4d6d;
            animation: floatUp 4s ease-in forwards;
            z-index: 10;
            pointer-events: none;
            will-change: transform, opacity;
        }
        
        @keyframes floatUp {
            0% { 
                transform: translateY(0) scale(0.8);
                opacity: 1;
            }
            100% { 
                transform: translateY(-120px) scale(1.3);
                opacity: 0;
            }
        }
        
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        
        .nav-btn {
            padding: 10px 20px;
            font-size: 14px;
            border: none;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .nav-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .reset-btn {
            padding: 10px 20px;
            font-size: 14px;
            border: none;
            border-radius: 50px;
            background: linear-gradient(45deg, #ff4d6d, #ff758f);
            color: white;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reset-btn:hover {
            background: linear-gradient(45deg, #ff758f, #ff4d6d);
        }
    </style>
</head>
<body>
    <div class="background"></div>
    <div class="overlay"></div>
    
    <div class="container">
        <button id="openBtn" class="btn">Buka kotaknya, Sayangku ‚ù§Ô∏è</button>
        
        <div class="gift-showcase" id="giftShowcase">
            <div class="gift-box" id="singleGiftBox">üéÅ</div>
        </div>
        
        <div class="message" id="message1">
            Selamat ulang tahun ya sayang ‚ù§Ô∏è Hari ini momen spesial buat kamu. Semoga setiap langkah kamu selalu ada kebahagiaan dan semua yang kamu pengen bisa tercapai. Semoga kamu selalu sehat lancar dan semua hal baik selalu nemenin kamu. Makasih udah jadi bagian terindah dalam hidup aku yang selalu bikin hari hariku lebih berwarna. Aku berharap kita bisa terus bareng dalam suka dan duka, sekarang dan nanti.
            <div class="nav-buttons">
                <button class="nav-btn" onclick="prevMessage()" disabled id="prevBtn1">Sebelumnya</button>
                <button class="nav-btn" onclick="nextMessage()" id="nextBtn1">Selanjutnya</button>
            </div>
        </div>
        
        <div class="message" id="message2">
            Di ulang tahun kamu yang ke 19 ini aku harap kamu makin bahagia makin kuat ngadepin segala tantangan dan makin sayang sama aku seperti aku sayang kamu. Aku pengen kamu tahu setiap waktu bareng kamu itu berarti banget dan nggak pernah aku sesali. Kamu itu anugerah yang luar biasa dan aku beneran bersyukur bisa ketemu kamu. Semoga tahun ini jadi awal dari banyak kebahagiaan yang bisa kita rayain bareng.
            <div class="nav-buttons">
                <button class="nav-btn" onclick="prevMessage()" id="prevBtn2">Sebelumnya</button>
                <button class="nav-btn" onclick="nextMessage()" id="nextBtn2">Selanjutnya</button>
            </div>
        </div>
        
        <div class="message" id="message3">
            Aku juga mau minta maaf kalau aku kadang bikin kamu sedih nyakitin hati atau kecewa. Aku tahu aku belum sempurna dan masih sering salah tapi rasa sayang aku ke kamu tulus banget. Aku doain kamu selalu sehat bahagia dan tetap semangat ngejar mimpi kamu. Semangat jadi koor nya semangat juga buat double degree nya. Aku yakin kamu pasti bisa aku selalu dukung kamu. Aku bangga banget punya kamu dan bakal terus berusaha bikin kamu bahagia. Kita jalani semuanya bareng ya sekarang dan selamanya ‚ù§Ô∏è
            <div class="nav-buttons">
                <button class="nav-btn" onclick="prevMessage()" id="prevBtn3">Sebelumnya</button>
                <button class="nav-btn" onclick="nextMessage()" disabled id="nextBtn3">Selanjutnya</button>
                <button class="reset-btn" onclick="resetPage()">Kembali ke Awal</button>
            </div>
        </div>
    </div>

    <audio id="birthdaySong" src="birthday.mp3" loop></audio>

    <script>
        // Optimized animation variables
        const animationSettings = {
            heartSizes: [18, 22, 26, 30],
            heartTypes: ['‚ù§Ô∏è', 'üíñ', 'üíó'],
            durations: [3.5, 4, 4.5]
        };

        // DOM elements
        const elements = {
            openBtn: document.getElementById('openBtn'),
            giftShowcase: document.getElementById('giftShowcase'),
            singleGiftBox: document.getElementById('singleGiftBox'),
            messages: [
                document.getElementById('message1'), 
                document.getElementById('message2'), 
                document.getElementById('message3')
            ],
            song: document.getElementById('birthdaySong'),
            prevButtons: [
                document.getElementById('prevBtn1'),
                document.getElementById('prevBtn2'),
                document.getElementById('prevBtn3')
            ],
            nextButtons: [
                document.getElementById('nextBtn1'),
                document.getElementById('nextBtn2'),
                document.getElementById('nextBtn3')
            ]
        };

        // State management
        let heartInterval;
        let currentMessageIndex = -1;

        // Main button click
        elements.openBtn.addEventListener('click', () => {
            elements.openBtn.style.display = 'none';
            elements.giftShowcase.style.display = 'flex';
            elements.song.play();
            startHeartAnimation();
        });

        // Single gift box click handler
        elements.singleGiftBox.addEventListener('click', function() {
            createHeartExplosion(25);
            elements.giftShowcase.style.display = 'none';
            showMessage(0);
        });

        function showMessage(index) {
            // Hide all messages first
            elements.messages.forEach(msg => msg.style.display = 'none');
            
            // Show the selected message
            currentMessageIndex = index;
            elements.messages[index].style.display = 'block';
        }

        function nextMessage() {
            if (currentMessageIndex < elements.messages.length - 1) {
                showMessage(currentMessageIndex + 1);
            }
        }

        function prevMessage() {
            if (currentMessageIndex > 0) {
                showMessage(currentMessageIndex - 1);
            }
        }

        function resetPage() {
            // Hide all messages
            elements.messages.forEach(msg => msg.style.display = 'none');
            // Show the main button
            elements.openBtn.style.display = 'block';
            // Hide gift showcase
            elements.giftShowcase.style.display = 'none';
            // Reset message index
            currentMessageIndex = -1;
            // Pause the song
            elements.song.pause();
            elements.song.currentTime = 0;
            // Clear heart animation
            if (heartInterval) clearInterval(heartInterval);
            // Remove all hearts
            document.querySelectorAll('.heart').forEach(heart => heart.remove());
        }

        function startHeartAnimation() {
            // Clear any existing interval
            if (heartInterval) clearInterval(heartInterval);
            
            // Create new gentle heart animation
            heartInterval = setInterval(() => {
                createHeart(1);
            }, 400);
        }

        function createHeart(count = 1) {
            for (let i = 0; i < count; i++) {
                const heart = document.createElement('div');
                heart.className = 'heart';
                heart.innerHTML = animationSettings.heartTypes[
                    Math.floor(Math.random() * animationSettings.heartTypes.length)
                ];
                
                // Position at bottom with random horizontal position
                heart.style.left = Math.random() * 100 + 'vw';
                heart.style.bottom = '10px';
                
                // Random size
                heart.style.fontSize = animationSettings.heartSizes[
                    Math.floor(Math.random() * animationSettings.heartSizes.length)
                ] + 'px';
                
                // Random duration
                heart.style.animationDuration = animationSettings.durations[
                    Math.floor(Math.random() * animationSettings.durations.length)
                ] + 's';
                
                document.body.appendChild(heart);
                
                // Cleanup after animation completes
                setTimeout(() => {
                    heart.remove();
                }, 4000);
            }
        }

        function createHeartExplosion(count) {
            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    createHeart(1);
                }, i * 50);
            }
        }

        // Cleanup on page hide/unload
        window.addEventListener('beforeunload', () => {
            if (heartInterval) clearInterval(heartInterval);
        });
    </script>
</body>
</html>